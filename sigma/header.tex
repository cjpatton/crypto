% header.tex
%
% Formatting and common macros for crypto papers. Include this first.
\usepackage[dvipsnames]{xcolor}
\usepackage{color,soul}
\usepackage{enumitem}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{xcolor}
\usepackage{xstring}
\usepackage{enumitem}


\usepackage{tikz}
\tikzset{>=latex}

\usepackage{listings}
\lstset{
  basicstyle=\small\ttfamily,
  columns=flexible,
  breaklines=true
}

\usepackage{hyperref}
\hypersetup{
  colorlinks,%
  citecolor=black,%
  filecolor=black,%
  linkcolor=black,%
  urlcolor=black
}

% Colors
\definecolor{theblue}{RGB}{85,135,170}
\definecolor{thedarkgray}{RGB}{95,95,95}
\definecolor{thedarkgreen}{RGB}{50,127,0}
\definecolor{thegray}{RGB}{165,165,165}
\definecolor{thelightblue}{RGB}{185,220,250}
\definecolor{thelightgray}{RGB}{230,230,230}
\definecolor{thelightred}{RGB}{250,185,165}
\definecolor{thered}{RGB}{210,145,125}

% Editorial
\newcommand{\ala}{\text{a la}\xspace}
\newcommand{\etal}{et al.\xspace}
\newcommand{\apriori}{\textit{a priori}\xspace}
\newcommand{\viceversa}{\textit{vice versa}\xspace}

% Fonts
\newcommand{\algorithmfont}[1]{\mathcal{#1}}
\newcommand{\codefont}[1]{\lstinline|#1|}
\newcommand{\cryptofont}[1]{\textup{\textbf{#1}}\hspace{0.5pt}}
\newcommand{\expfont}[1]{{{\tiny\MakeLowercase{\textnormal{#1}}}}}
\newcommand{\lifont}[1]{\textsf{\footnotesize\color{thegray}#1}}
\newcommand{\notionfont}[1]{{#1}\xspace}
\newcommand{\oraclefont}[1]{\cryptofont{#1}}
\newcommand{\procfont}[1]{\textnormal{#1}\hspace{0.33pt}}
\newcommand{\schemefont}[1]{\mathcal{#1}}
\newcommand{\setfont}[1]{\mathcal{#1}}
\newcommand{\rwordfont}[1]{\cryptofont{#1}\xspace}
\newcommand{\strfont}[1]{\textup{\textsf{{\color{theblue}#1}}}}
\newcommand{\varfont}[1]{\mathit{#1}}
\newcommand{\symbolfont}[1]{\textsf{\footnotesize\color{thegray}#1}}

\newcommand{\stringer}[1]{\strfont{#1}}
\newcommand{\rword}[1]{\rwordfont{#1}}

% Crypto functions
\newcommand{\Hybrid}{\cryptofont{H}}
\newcommand{\Gam}{\cryptofont{G}}
\newcommand{\Exp}[1]{\cryptofont{Exp}^{\expfont{#1}}}
\newcommand{\Adv}[1]{\cryptofont{Adv}^{\expfont{#1}}}

% Types
\newcommand{\typ}[1]{\typs\rword{#1}}
\newcommand{\typs}{\,}
\newcommand{\us}{\!} % previously \unskip

\newcommand{\rbool}{\typ{bool}}
\newcommand{\relem}[1]{\typ{elem}(#1)}
\newcommand{\rint}{\typ{int}}
\newcommand{\rset}{\typ{set}}
\newcommand{\rstr}{\typ{str}}
\newcommand{\rstruct}{\typ{struct}}
\newcommand{\rtuple}{\typ{tup}}

\newcommand{\rdet}{\rword{det}\typs}
\newcommand{\rtype}{\rword{type}}
\newcommand{\rrand}{\rword{rand}\typs}

%% Fancy syntax stuff
\newcommand{\nil}{\symbolfont{nil}}
\newcommand{\ptr}{\typs\symbolfont{*}\us}
\newcommand{\rfr}{\symbolfont{\&}}
\newcommand{\any}{\symbolfont{\_}}

%% Reserved words
\newcommand{\rand}{\rwordfont{and}}
\newcommand{\rdeclare}{\rwordfont{dec}}
\newcommand{\relse}{\rwordfont{else}}
\newcommand{\rif}{\rwordfont{if}}
\newcommand{\rwhile}{\rwordfont{while}}
\newcommand{\runtil}{\rwordfont{until}}
\newcommand{\rdo}{\rwordfont{do}}
\newcommand{\ror}{\rwordfont{or}}
\newcommand{\rfor}{\rwordfont{for}}
\newcommand{\rforeach}{\rwordfont{for each}}
\newcommand{\rreturn}{\rwordfont{ret}}
\newcommand{\rbreak}{\rwordfont{break}}
\newcommand{\rthen}{\rwordfont{then}}
\newcommand{\rto}{\rwordfont{to}}
\newcommand{\rswitch}{\rwordfont{switch}}
\newcommand{\rcase}{\rwordfont{case}}
\newcommand{\rdefault}{\rwordfont{default}}

% Math
\DeclareMathAlphabet\mathbfcal{OMS}{cmsy}{b}{n}

\def\v.#1{\boldsymbol{#1}}
\newcommand{\dqed}{\hfill$\Diamond$}
\newcommand{\GF}{\mathit{GF}}

%% Sets
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\dom}{Dom}
\DeclareMathOperator*{\rng}{Rng}
\def\bydef{\stackrel{\rm def}{=}}
\newcommand*\by{\times}
\newcommand{\getsr}{\xleftarrow{\text{\tiny{\$}}}}
%\newcommand{\getsr}{{\:{\leftarrow{\hspace*{-3pt}\raisebox{.75pt}{$\scriptscriptstyle\$$}}}\:}}
\newcommand*\intersection{\cap}
\newcommand{\multiunion}{\uplus}
\newcommand*\union{\cup}

%% String/tuple operators
\def\slicerange#1,#2{#1\mbox{\hspace{0.5pt}:\hspace{0.5pt}}#2}
\newcommand{\bits}{\{0,1\}}
\newcommand{\cat}{\, \| \,}
\newcommand{\emptystr}{\varepsilon}
\newcommand{\emptystring}{\emptystr}
\newcommand{\hassubstr}{\sim}
\newcommand{\prefixes}{\preceq}
\newcommand{\slice}[2]{#1[\slicerange#2]}
\newcommand{\toint}[2]{\underline{\smash{#1}}_{\hspace{0.5pt}#2}}
\newcommand{\tostr}[1]{\underline{\smash{#1}}}
\newcommand{\trunc}{\%}

%% Boolean operators
\newcommand*\band{\wedge}
\newcommand*\bor{\vee}
\newcommand*\bnot{\neg}
\newcommand*\bimplies{\implies}
\newcommand*\bxor{\mathbin{\oplus}}

%% Probability
\newcommand{\E}{\mathrm{E}}
\newcommand{\Prob}[1]{\Pr\hspace{-1pt}\big[\,#1\,\big]}
\newcommand{\Probs}[2]{\Pr_{#1}\hspace{-1pt}{\big[\,#2\,\big]}}
\newcommand{\given}{\mid}

% References
\newcommand{\fig}[1]{Fig.~\ref{fig:#1}}
\newcommand{\lem}[1]{Lemma~\ref{lemma:#1}}

% Dev
\def\coloroverride{0}
\newenvironment{cleanup}{
  \def\coloroverride{1}
  \color{gray}
}{
}

% Notes
\newcounter{notectr}[section]
\newcommand{\getnotectr}{\stepcounter{notectr}\thesection.\thenotectr}

\newcommand{\basenoteshape}[3]{(\getnotectr: #1\xspace#2: #3)}

\newcommand{\basenote}[4]{%
  \textrm{%
    \IfEqCase{\coloroverride}{%
        {1}{\basenoteshape{#2}{#3}{#4}}%
        {0}{\textcolor{#1}{\basenoteshape{#2}{#3}{#4}}}%
    }[\PackageError{basenote}{Undefined option for basenote: \coloroverride}{}]%
  }%
}

%% Uncomment to mute notes.
%\renewcommand{\basenote}[4]{\ignorespaces}

\newcommand{\todo}[3]{\basenote{#1}{#2}{todo}{#3}}
\newcommand{\fixme}[1]{\basenote{red}{}{fixme}{{\bf#1}}}

\newcommand{\ignore}[1]{\if{0}#1\fi}

% Games
\renewcommand{\#}[1]{\text{\textcolor{theblue}{\,\text{//}\,{\small #1}}}}
\newcommand{\g}[1]{\cryptofont{G}_{#1}}
\newcommand{\hybrid}[1]{\cryptofont{H}_{#1}}
\newcommand{\gouts}{=}
\newcommand{\gsets}{\,\cryptofont{sets}\,}
\newcommand{\tab}{\hspace*{10pt}}

%% Diffs
\newcommand{\diffplus}[1]{\fbox{#1}}
\newcommand{\diffplusbox}[1]{\fbox{\parbox{\dimexpr\textwidth-2\fboxsep-2\fboxrule\relax}{#1}}\vspace{1pt}}
\newcommand{\diffminus}[1]{\colorbox{lightgray}{#1}}
\newcommand{\diffminusbox}[1]{\colorbox{lightgray}{\parbox{\dimexpr\textwidth-2\fboxsep-2\fboxrule\relax}{#1}}}
\newcommand{\diff}[2]{\diffminus{#1}\diffplus{#2}}

%% Line numbers
\newcommand{\liref}[2]{\fig{#1}:#2}
\newcounter{FunctionCounter}
\newcounter{LineCounter}[FunctionCounter]

%%% Reset numbering (new game)
\newcommand{\ga}{\setcounter{FunctionCounter}{0}\setcounter{LineCounter}{0}}

%%% Increment function number
\newcommand{\fu}{
%  \stepcounter{FunctionCounter}
}

%%% Increment line number
\usepackage{calc}
\newcommand{\li}{
%  \stepcounter{LineCounter}\lifont{\scriptsize\theFunctionCounter\ifnum\value{LineCounter}<10\ignorespaces0\fi\theLineCounter}
  \stepcounter{LineCounter}\makebox[8pt][r]{\lifont{\scriptsize\theLineCounter}}\hspace{2pt}
}

%% Boxes
\newcommand{\gamesfontsize}{\small}
\newcommand{\gamespadleft}{\hskip 1pt}
\newcommand{\gamespad}{\hskip 4pt}
\newcommand{\gamespacer}{\\[-6.5pt]}

\newcommand{\oneCol}[2]{
  \begin{center}
    \makebox[\textwidth][l]{
      \begin{tabular}{|@{\gamespadleft}l@{\gamespad}@{}|}
      \hline
      \rule{0pt}{1\normalbaselineskip}
      \begin{minipage}[t]{#1\textwidth}\gamesfontsize
        #2 \vspace{6pt}
      \end{minipage} \\
      \hline
    \end{tabular}
    }
  \end{center}
}

\newcommand{\twoCols}[3]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\twoColsNoBox}[3]{
  \makebox[\textwidth][c]{
    \begin{tabular}{@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}}
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} \\
  \end{tabular}
  }
}

\newcommand{\twoColsUnbalanced}[4]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\twoColsNoLinesUnbalanced}[4]{
  \makebox[\textwidth][c]{
    \begin{tabular}{@{\gamespadleft}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}}
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} \\
  \end{tabular}
  }
}

\newcommand{\twoColsNoDivide}[3]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\twoColsNoDivideUnbalanced}[4]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\twoColsTwoRows}[5]{
  \makebox[\textwidth][c]{
  \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} \\
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\threeCols}[4]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\threeColsUnbalanced}[6]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#3\textwidth}\gamesfontsize
      #6 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\threeColsFirstDivideUnbalanced}[6]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#3\textwidth}\gamesfontsize
      #6 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\threeColsSecondDivideUnbalanced}[6]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}@{}|@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#3\textwidth}\gamesfontsize
      #6 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\threeColsNoDivideUnbalanced}[6]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#2\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#3\textwidth}\gamesfontsize
      #6 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\fourCols}[5]{
  \makebox[\textwidth][c]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\newcommand{\twoColsThreeRows}[7]{
  \makebox[\textwidth][c]{
  \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|@{}@{\gamespad}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #3 \vspace{6pt}
    \end{minipage} \\
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #4 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #5 \vspace{6pt}
    \end{minipage} \\
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #6 \vspace{6pt}
    \end{minipage} &
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
       #7 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}
